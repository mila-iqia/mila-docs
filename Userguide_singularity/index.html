
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mila-iqia.github.io/docs/Userguide_singularity/">
      
      
        <link rel="prev" href="../Userguide_jupyterhub/">
      
      
        <link rel="next" href="../Userguide_faq/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Singularity - Mila Technical Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#singularity" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
üéâ We're giving the docs a fresh makeover! You can expect things to move around a bit while we redesign and reorganize the documentation.
Fear not ‚Äî the old docs are still available at <a href="https://mila-docs.readthedocs.io">mila-docs.readthedocs.io</a>.
Spotted a
bug? üêõ <a href="https://github.com/mila-iqia/mila-docs/issues/new">File a
    ticket</a> and we'll take a look at it!

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Mila Technical Documentation" class="md-header__button md-logo" aria-label="Mila Technical Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mila Technical Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Singularity
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://www.github.com/mila-iqia/mila-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mila-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Mila Technical Documentation" class="md-nav__button md-logo" aria-label="Mila Technical Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Mila Technical Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://www.github.com/mila-iqia/mila-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mila-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Introduction
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Purpose/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Purpose of this documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    How-tos and Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-tos and Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging in to the cluster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_running_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running your code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_portability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Portability concerns and solutions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using containers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_sharing_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sharing Data with ACLs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_data_transfer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Transmission using Globus Connect Personal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_multigpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced SLURM usage and Multiple GPU jobs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_multinode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple Nodes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_wandb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weights and Biases (WandB)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_comet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_jupyterhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JupyterHub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Singularity
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Singularity
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Singularity?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#links-to-official-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Links to official documentation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview-of-the-steps-used-in-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview of the steps used in practice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nope-not-on-macos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nope, not on MacOS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-build-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Where to build images
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-containers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building the containers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building the containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-way-build-and-use-a-sandbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        First way: Build and use a sandbox
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="First way: Build and use a sandbox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-containers-from-the-web" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download containers from the web
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-add-or-install-stuff-in-a-container" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to add or install stuff in a container
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-useful-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating useful directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-new-image-from-the-sandbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a new image from the sandbox
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#second-way-use-recipes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Second way: Use recipes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Second way: Use recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-recipe-on-singularity-hub" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build recipe on singularity hub
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-recipe-with-openai-gym-mujoco-and-miniworld" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Recipe with OpenAI gym, MuJoCo and Miniworld
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-containers-on-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using containers on clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using containers on clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-use-containers-on-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to use containers on clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use containers on clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-interactive-case-srunsalloc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Interactive case (srun/salloc)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-sbatch-case" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: sbatch case
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-with-pybullet-and-opengl-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue with PyBullet and OpenGL libraries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mila-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mila cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digital-research-alliance-of-canada" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Research Alliance of Canada
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Userguide_faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Frequently asked questions (FAQ)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Systems and services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Systems and services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Computing infrastructure and policies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Computing infrastructure and policies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computing infrastructure and policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_roles_and_resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roles and computing resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Node profile description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_sharing_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data sharing policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_data_transmission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Transmission
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Information_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Extra_compute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computational resources outside of Mila
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Minimal Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Minimal Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples/frameworks/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Software Frameworks
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software Frameworks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/frameworks/pytorch_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/frameworks/jax_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jax Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/frameworks/jax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jax
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples/distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Distributed Training
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Distributed Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/distributed/single_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single GPU Job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/distributed/multi_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-GPU Job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/distributed/multi_node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-node Job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples/good_practices/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Good Practices
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Good Practices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/checkpointing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Checkpointing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/wandb_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weights & Biases (wandb) setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/launch_many_jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Launch many jobs from same shell script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/hpo_with_orion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Optimization with Orion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/many_tasks_per_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Launch many tasks on the same GPU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/good_practices/slurm_job_arrays/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Launch many jobs using SLURM job arrays
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples/advanced/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Advanced Examples
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/advanced/imagenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Node / Multi-GPU ImageNet Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://mila-iqia.github.io/ResearchTemplate" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üîó Research Project Template
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    General Theory
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    General Theory
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Theory_cluster_parts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What is a computer cluster?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Theory_cluster_unix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Theory_cluster_batch_scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The workload manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Theory_cluster_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Processing data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Theory_cluster_software_deps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software on the cluster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Extras
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Extras
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Acknowledgement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Acknowledging Mila
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://datasets.server.mila.quebec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mila Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Audio_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audio and video resources at Mila
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VSCode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Studio Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../IDT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Who, what, where is IDT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cheat Sheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Environmental_impact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environmental Impact
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Singularity?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#links-to-official-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Links to official documentation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview-of-the-steps-used-in-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview of the steps used in practice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nope-not-on-macos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nope, not on MacOS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-build-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Where to build images
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-containers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building the containers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building the containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-way-build-and-use-a-sandbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        First way: Build and use a sandbox
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="First way: Build and use a sandbox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-containers-from-the-web" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download containers from the web
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-add-or-install-stuff-in-a-container" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to add or install stuff in a container
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-useful-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating useful directories
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-new-image-from-the-sandbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a new image from the sandbox
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#second-way-use-recipes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Second way: Use recipes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Second way: Use recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-recipe-on-singularity-hub" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build recipe on singularity hub
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-recipe-with-openai-gym-mujoco-and-miniworld" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Recipe with OpenAI gym, MuJoCo and Miniworld
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-containers-on-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using containers on clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using containers on clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-use-containers-on-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to use containers on clusters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use containers on clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-interactive-case-srunsalloc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Interactive case (srun/salloc)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-sbatch-case" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: sbatch case
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-with-pybullet-and-opengl-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue with PyBullet and OpenGL libraries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mila-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mila cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digital-research-alliance-of-canada" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Research Alliance of Canada
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="singularity">Singularity<a class="headerlink" href="#singularity" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<h3 id="what-is-singularity">What is Singularity?<a class="headerlink" href="#what-is-singularity" title="Permanent link">&para;</a></h3>
<p>Running Docker on SLURM is a security problem (e.g. running as root, being able
to mount any directory).  The alternative is to use Singularity, which is a
popular solution in the world of HPC.</p>
<p>There is a good level of compatibility between Docker and Singularity,
and we can find many exaggerated claims about able to convert containers
from Docker to Singularity without any friction.
Oftentimes, Docker images from DockerHub are 100% compatible with Singularity,
and they can indeed be used without friction, but things get messy when
we try to convert our own Docker build files to Singularity recipes.</p>
<h3 id="links-to-official-documentation">Links to official documentation<a class="headerlink" href="#links-to-official-documentation" title="Permanent link">&para;</a></h3>
<ul>
<li>official <a href="https://singularity-docs.readthedocs.io/en/latest/">Singularity user guide</a>
  (this is the one you will use most often)</li>
<li>official <a href="https://sylabs.io/guides/latest/admin-guide/">Singularity admin guide</a></li>
</ul>
<h3 id="overview-of-the-steps-used-in-practice">Overview of the steps used in practice<a class="headerlink" href="#overview-of-the-steps-used-in-practice" title="Permanent link">&para;</a></h3>
<p>Most often, the process to create and use a Singularity container is:</p>
<ul>
<li>
<p>on your Linux computer (at home or work)</p>
</li>
<li>
<p>select a Docker image from DockerHub (e.g. <em>pytorch/pytorch</em>)</p>
</li>
<li>make a recipe file for Singularity that starts with that DockerHub image</li>
<li>build the recipe file, thus creating the image file (e.g. <code>my-pytorch-image.sif</code>)</li>
<li>test your singularity container before send it over to the cluster</li>
<li>
<p><code>rsync -av my-pytorch-image.sif &lt;login-node&gt;:Documents/my-singularity-images</code></p>
</li>
<li>
<p>on the login node for that cluster</p>
</li>
<li>
<p>queue your jobs with <code>sbatch ...</code></p>
</li>
<li>(note that your jobs will copy over the <code>my-pytorch-image.sif</code> to $SLURM_TMPDIR
    and will then launch Singularity with that image)</li>
<li>do something else while you wait for them to finish</li>
<li>queue more jobs with the same <code>my-pytorch-image.sif</code>,
    reusing it many times over</li>
</ul>
<p>In the following sections you will find specific examples or tips to accomplish
in practice the steps highlighted above.</p>
<h3 id="nope-not-on-macos">Nope, not on MacOS<a class="headerlink" href="#nope-not-on-macos" title="Permanent link">&para;</a></h3>
<p>Singularity does not work on MacOS, as of the time of this writing in 2021.
Docker does not <em>actually</em> run on MacOS, but there Docker silently installs a
virtual machine running Linux, which makes it a pleasant experience,
and the user does not need to care about the details of how Docker does it.</p>
<p>Given its origins in HPC, Singularity does not provide that kind of seamless
experience on MacOS, even though it's technically possible to run it
inside a Linux virtual machine on MacOS.</p>
<h3 id="where-to-build-images">Where to build images<a class="headerlink" href="#where-to-build-images" title="Permanent link">&para;</a></h3>
<p>Building Singularity images is a rather heavy task, which can take 20 minutes
if you have a lot of steps in your recipe. This makes it a bad task to run on
the login nodes of our clusters, especially if it needs to be run regularly.</p>
<p>On the Mila cluster, we are lucky to have unrestricted internet access on the compute
nodes, which means that anyone can request an interactive CPU node (no need for GPU)
and build their images there without problem.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not build Singularity images from scratch every time your run a job in a
large batch.  This will be a colossal waste of GPU time as well as internet
bandwidth. If you setup your workflow properly (e.g. using bind paths for
your code and data), you can spend months reusing the same Singularity image
<code>my-pytorch-image.sif</code>.</p>
</div>
<h2 id="building-the-containers">Building the containers<a class="headerlink" href="#building-the-containers" title="Permanent link">&para;</a></h2>
<p>Building a container is like creating a new environment except that containers
are much more powerful since they are self-contained systems.  With
singularity, there are two ways to build containers.</p>
<p>The first one is by yourself, it's like when you got a new Linux laptop and you
don't really know what you need, if you see that something is missing, you
install it. Here you can get a vanilla container with Ubuntu called a sandbox,
you log in and you install each packages by yourself.  This procedure can take
time but will allow you to understand how things work and what you need. This is
recommended if you need to figure out how things will be compiled or if you want
to install packages on the fly. We'll refer to this procedure as singularity
sandboxes.</p>
<p>The second way is more like you know what you want, so you write a list of
everything you need, you send it to singularity and it will install everything
for you. Those lists are called singularity recipes.</p>
<h3 id="first-way-build-and-use-a-sandbox">First way: Build and use a sandbox<a class="headerlink" href="#first-way-build-and-use-a-sandbox" title="Permanent link">&para;</a></h3>
<p>You might ask yourself: <em>On which machine should I build a container?</em></p>
<p>First of all, you need to choose where you'll build your container. This
operation requires <strong>memory and high cpu usage</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Do NOT build containers on any login nodes!</p>
</div>
<ul>
<li>
<p>(Recommended for beginner) If you need to <strong>use apt-get</strong>, you should <strong>build
  the container on your laptop</strong> with sudo privileges. You'll only need to
  install singularity on your laptop. Windows/Mac users can look <code>there</code>_ and
  Ubuntu/Debian users can use directly:
  <div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>singularity-container
</span></code></pre></div></p>
</li>
<li>
<p>If you <strong>can't install singularity</strong> on your laptop and you <strong>don't need
    apt-get</strong>, you can reserve a <strong>cpu node on the Mila cluster</strong> to build your
    container.</p>
<p>In this case, in order to avoid too much I/O over the network, you should define
the singularity cache locally:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SINGULARITY_CACHEDIR</span><span class="o">=</span><span class="nv">$SLURM_TMPDIR</span>
</span></code></pre></div>
</li>
<li>
<p>If you <strong>can't install singularity</strong> on your laptop and you <strong>want to use
  apt-get</strong>, you can use <code>singularity-hub</code><em> to build your containers and read
  Recipe_section</em>.</p>
</li>
</ul>
<h4 id="download-containers-from-the-web">Download containers from the web<a class="headerlink" href="#download-containers-from-the-web" title="Permanent link">&para;</a></h4>
<p>Hopefully, you may not need to create containers from scratch as many have been
already built for the most common deep learning software. You can find most of
them on <a href="https://hub.docker.com/">dockerhub</a>.</p>
<p>Go on <a href="https://hub.docker.com/">dockerhub</a> and select the container you want to pull.</p>
<p>For example, if you want to get the latest PyTorch version with GPU support
(Replace <em>runtime</em> by <em>devel</em> if you need the full Cuda toolkit):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>singularity<span class="w"> </span>pull<span class="w"> </span>docker://pytorch/pytorch:1.0.1-cuda10.0-cudnn7-runtime
</span></code></pre></div>
<p>Or the latest TensorFlow:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>singularity<span class="w"> </span>pull<span class="w"> </span>docker://tensorflow/tensorflow:latest-gpu-py3
</span></code></pre></div>
<p>Currently the pulled image <code>pytorch.simg</code> or <code>tensorflow.simg</code> is read-only
meaning that you won't be able to install anything on it.  Starting now, PyTorch
will be taken as example. If you use TensorFlow, simply replace every
<strong>pytorch</strong> occurrences by <strong>tensorflow</strong>.</p>
<h4 id="how-to-add-or-install-stuff-in-a-container">How to add or install stuff in a container<a class="headerlink" href="#how-to-add-or-install-stuff-in-a-container" title="Permanent link">&para;</a></h4>
<p>The first step is to transform your read only container
<code>pytorch-1.0.1-cuda10.0-cudnn7-runtime.simg</code> in a writable version that will
allow you to add packages.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Depending on the version of singularity you are using, singularity
will build a container with the extension .simg or .sif. If you're using
.sif files, replace every occurences of .simg by .sif.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to use <strong>apt-get</strong> you have to put <strong>sudo</strong> ahead of the 
following commands</p>
</div>
<p>This command will create a writable image in the folder <code>pytorch</code>.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>singularity<span class="w"> </span>build<span class="w"> </span>--sandbox<span class="w"> </span>pytorch<span class="w"> </span>pytorch-1.0.1-cuda10.0-cudnn7-runtime.simg
</span></code></pre></div>
Then you'll need the following command to log inside the container.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>singularity<span class="w"> </span>shell<span class="w"> </span>--writable<span class="w"> </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span>pytorch
</span></code></pre></div>
Once you get into the container, you can use pip and install anything you need
(Or with <code>apt-get</code> if you built the container with sudo).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Singularity mounts your home folder, so if you install things into
the <code>$HOME</code> of your container, they will be installed in your real
<code>$HOME</code>!</p>
</div>
<p>You should install your stuff in /usr/local instead.</p>
<h4 id="creating-useful-directories">Creating useful directories<a class="headerlink" href="#creating-useful-directories" title="Permanent link">&para;</a></h4>
<p>One of the benefits of containers is that you'll be able to use them across
different clusters. However for each cluster the datasets and experiments
folder location can be different. In order to be invariant to those locations,
we will create some useful mount points inside the container:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>&lt;Singularity_container&gt;$<span class="w"> </span>mkdir<span class="w"> </span>/dataset
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>&lt;Singularity_container&gt;$<span class="w"> </span>mkdir<span class="w"> </span>/tmp_log
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>&lt;Singularity_container&gt;$<span class="w"> </span>mkdir<span class="w"> </span>/final_log
</span></code></pre></div>
<p>From now, you won't need to worry anymore when you write your code to specify
where to pick up your dataset. Your dataset will always be in <code>/dataset</code>
independently of the cluster you are using.</p>
<h4 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h4>
<p>If you have some code that you want to test before finalizing your container,
you have two choices.  You can either log into your container and run Python
code inside it with:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>singularity<span class="w"> </span>shell<span class="w"> </span>--nv<span class="w"> </span>pytorch
</span></code></pre></div>
Or you can execute your command directly with
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span>pytorch<span class="w"> </span>Python<span class="w"> </span>YOUR_CODE.py
</span></code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>---nv allows the container to use gpus. You don't need this if you don't plan to use a gpu.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don't forget to clear the cache of the packages you installed in
the containers.</p>
</div>
<h4 id="creating-a-new-image-from-the-sandbox">Creating a new image from the sandbox<a class="headerlink" href="#creating-a-new-image-from-the-sandbox" title="Permanent link">&para;</a></h4>
<p>Once everything you need is installed inside the container, you need to convert
it back to a read-only singularity image with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>singularity<span class="w"> </span>build<span class="w"> </span>pytorch_final.simg<span class="w"> </span>pytorch
</span></code></pre></div>
<h3 id="second-way-use-recipes">Second way: Use recipes<a class="headerlink" href="#second-way-use-recipes" title="Permanent link">&para;</a></h3>
<p>A singularity recipe is a file including specifics about installation software,
environment variables, files to add, and container metadata.  It is a starting
point for designing any custom container. Instead of pulling a container and
installing your packages manually, you can specify in this file the packages
you want and then build your container from this file.</p>
<p>Here is a toy example of a singularity recipe installing some stuff:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">################# Header: Define the base system you want to use ################</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># Reference of the kind of base you want to use (e.g., docker, debootstrap, shub).</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Bootstrap:<span class="w"> </span>docker
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># Select the docker image you want to use (Here we choose tensorflow)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>From:<span class="w"> </span>tensorflow/tensorflow:latest-gpu-py3
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c1">################# Section: Defining the system #################################</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1"># Commands in the %post section are executed within the container.</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>%post
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing Tools with apt-get&quot;</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">        </span>apt-get<span class="w"> </span>update
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>cmake<span class="w"> </span>libcupti-dev<span class="w"> </span>libyaml-dev<span class="w"> </span>wget<span class="w"> </span>unzip
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">        </span>apt-get<span class="w"> </span>clean
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing things with pip&quot;</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>tqdm
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Creating mount points&quot;</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">        </span>mkdir<span class="w"> </span>/dataset
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">        </span>mkdir<span class="w"> </span>/tmp_log
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">        </span>mkdir<span class="w"> </span>/final_log
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c1"># Environment variables that should be sourced at runtime.</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>%environment
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">        </span><span class="c1"># use bash as default shell</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">        </span><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span>SHELL
</span></code></pre></div>
<p>A recipe file contains two parts: the <code>header</code> and <code>sections</code>. In the
<code>header</code> you specify which base system you want to use, it can be any docker
or singularity container. In <code>sections</code>, you can list the things you want to
install in the subsection <code>post</code> or list the environment's variable you need
to source at each runtime in the subsection <code>environment</code>. For a more detailed
description, please look at the <a href="https://www.sylabs.io/guides/2.6/user-guide/container_recipes.html#container-recipes">singularity documentation</a>.</p>
<p>In order to build a singularity container from a singularity recipe file, you
should use:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo<span class="w"> </span>singularity<span class="w"> </span>build<span class="w"> </span>&lt;NAME_CONTAINER&gt;<span class="w"> </span>&lt;YOUR_RECIPE_FILES&gt;
</span></code></pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>You always need to use sudo when you build a container from a
   recipe. As there is no access to sudo on the cluster, a personal computer or
   the use singularity hub is needed to build a container</p>
<h4 id="build-recipe-on-singularity-hub">Build recipe on singularity hub<a class="headerlink" href="#build-recipe-on-singularity-hub" title="Permanent link">&para;</a></h4>
<!-- TODO: Out of date, singularity hub might not be still up. Double-check. -->

<p>Singularity hub allows users to build containers from recipes directly on
singularity-hub's cloud meaning that you don't need to build containers by
yourself.  You need to register on <a href="https://www.singularity-hub.org/">singularity-hub</a> and link your
singularity-hub account to your GitHub account, then:</p>
<ol>
<li>Create a new github repository.</li>
<li>Add a collection on <a href="https://www.singularity-hub.org/">singularity-hub</a> and select the github repository your created.</li>
<li>
<p>Clone the github repository on your computer.
    <div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>&lt;url&gt;
</span></code></pre></div></p>
</li>
<li>
<p>Write the singularity recipe and save it as a file named <strong>Singularity</strong>.</p>
</li>
<li>
<p>Git add <strong>Singularity</strong>, commit and push on the master branch</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>Singularity
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>$<span class="w"> </span>git<span class="w"> </span>commit
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>master
</span></code></pre></div>
</li>
</ol>
<p>At this point, robots from singularity-hub will build the container for you, you
will be able to download your container from the website or directly with:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>singularity<span class="w"> </span>pull<span class="w"> </span>shub://&lt;github_username&gt;/&lt;repository_name&gt;
</span></code></pre></div></p>
<h4 id="example-recipe-with-openai-gym-mujoco-and-miniworld">Example: Recipe with OpenAI gym, MuJoCo and Miniworld<a class="headerlink" href="#example-recipe-with-openai-gym-mujoco-and-miniworld" title="Permanent link">&para;</a></h4>
<p>Here is an example on how you can use a singularity recipe to install complex
environment such as OpenAI gym, MuJoCo and Miniworld on a PyTorch based
container. In order to use MuJoCo, you'll need to copy the key stored on the
Mila cluster in <code>/ai/apps/mujoco/license/mjkey.txt</code> to your current directory.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">#This is a dockerfile that sets up a full Gym install with test dependencies</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>Bootstrap:<span class="w"> </span>docker
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Here we ll build our container upon the pytorch container</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>From:<span class="w"> </span>pytorch/pytorch:1.0-cuda10.0-cudnn7-runtime
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># Now we&#39;ll copy the mjkey file located in the current directory inside the container&#39;s root</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="c1"># directory</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>%files
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">        </span>mjkey.txt
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="c1"># Then we put everything we need to install</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>%post
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/opt/conda/bin
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">        </span>apt<span class="w"> </span>-y<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">        </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>keyboard-configuration<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">        </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">        </span>python3-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">        </span>python-pyglet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">        </span>python3-opengl<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">        </span>libhdf5-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">        </span>libjpeg-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">        </span>libboost-all-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">        </span>libsdl2-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">        </span>libosmesa6-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">        </span>patchelf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">        </span>ffmpeg<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w">        </span>xvfb<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w">        </span>libhdf5-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w">        </span>openjdk-8-jdk<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w">        </span>wget<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="w">        </span>git<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="w">        </span>unzip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="w">        </span>apt<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a><span class="w">        </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>h5py
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="w">        </span><span class="c1"># Download Gym and MuJoCo</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a><span class="w">        </span>mkdir<span class="w"> </span>/Gym<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/Gym
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a><span class="w">        </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/openai/gym.git<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a><span class="w">        </span>mkdir<span class="w"> </span>/Gym/.mujoco<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/Gym/.mujoco
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="w">        </span>wget<span class="w"> </span>https://www.roboti.us/download/mjpro150_linux.zip<span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a><span class="w">        </span>unzip<span class="w"> </span>mjpro150_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a><span class="w">        </span>wget<span class="w"> </span>https://www.roboti.us/download/mujoco200_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a><span class="w">        </span>unzip<span class="w"> </span>mujoco200_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a><span class="w">        </span>mv<span class="w"> </span>mujoco200_linux<span class="w"> </span>mujoco200
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48" href="#__codelineno-15-48"></a><span class="w">        </span><span class="c1"># Export global environment variables</span>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49" href="#__codelineno-15-49"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MJKEY_PATH</span><span class="o">=</span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50" href="#__codelineno-15-50"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MUJOCO_PATH</span><span class="o">=</span>/Gym/.mujoco/mujoco150/
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51" href="#__codelineno-15-51"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mjpro150/bin
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52" href="#__codelineno-15-52"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mujoco200/bin
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53" href="#__codelineno-15-53"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/bin
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54" href="#__codelineno-15-54"></a><span class="w">        </span>cp<span class="w"> </span>/mjkey.txt<span class="w"> </span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55" href="#__codelineno-15-55"></a><span class="w">        </span><span class="c1"># Install Python dependencies</span>
</span><span id="__span-15-56"><a id="__codelineno-15-56" name="__codelineno-15-56" href="#__codelineno-15-56"></a><span class="w">        </span>wget<span class="w"> </span>https://raw.githubusercontent.com/openai/mujoco-py/master/requirements.txt
</span><span id="__span-15-57"><a id="__codelineno-15-57" name="__codelineno-15-57" href="#__codelineno-15-57"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-15-58"><a id="__codelineno-15-58" name="__codelineno-15-58" href="#__codelineno-15-58"></a><span class="w">        </span><span class="c1"># Install Gym and MuJoCo</span>
</span><span id="__span-15-59"><a id="__codelineno-15-59" name="__codelineno-15-59" href="#__codelineno-15-59"></a><span class="w">        </span><span class="nb">cd</span><span class="w"> </span>/Gym/gym
</span><span id="__span-15-60"><a id="__codelineno-15-60" name="__codelineno-15-60" href="#__codelineno-15-60"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;.[all]&#39;</span>
</span><span id="__span-15-61"><a id="__codelineno-15-61" name="__codelineno-15-61" href="#__codelineno-15-61"></a><span class="w">        </span><span class="c1"># Change permission to use mujoco_py as non sudoer user</span>
</span><span id="__span-15-62"><a id="__codelineno-15-62" name="__codelineno-15-62" href="#__codelineno-15-62"></a><span class="w">        </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">777</span><span class="w"> </span>/opt/conda/lib/python3.6/site-packages/mujoco_py/
</span><span id="__span-15-63"><a id="__codelineno-15-63" name="__codelineno-15-63" href="#__codelineno-15-63"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>minerl
</span><span id="__span-15-64"><a id="__codelineno-15-64" name="__codelineno-15-64" href="#__codelineno-15-64"></a>
</span><span id="__span-15-65"><a id="__codelineno-15-65" name="__codelineno-15-65" href="#__codelineno-15-65"></a><span class="c1"># Export global environment variables</span>
</span><span id="__span-15-66"><a id="__codelineno-15-66" name="__codelineno-15-66" href="#__codelineno-15-66"></a>%environment
</span><span id="__span-15-67"><a id="__codelineno-15-67" name="__codelineno-15-67" href="#__codelineno-15-67"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">SHELL</span><span class="o">=</span>/bin/sh
</span><span id="__span-15-68"><a id="__codelineno-15-68" name="__codelineno-15-68" href="#__codelineno-15-68"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MJKEY_PATH</span><span class="o">=</span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-15-69"><a id="__codelineno-15-69" name="__codelineno-15-69" href="#__codelineno-15-69"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MUJOCO_PATH</span><span class="o">=</span>/Gym/.mujoco/mujoco150/
</span><span id="__span-15-70"><a id="__codelineno-15-70" name="__codelineno-15-70" href="#__codelineno-15-70"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mjpro150/bin
</span><span id="__span-15-71"><a id="__codelineno-15-71" name="__codelineno-15-71" href="#__codelineno-15-71"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mujoco200/bin
</span><span id="__span-15-72"><a id="__codelineno-15-72" name="__codelineno-15-72" href="#__codelineno-15-72"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/bin
</span><span id="__span-15-73"><a id="__codelineno-15-73" name="__codelineno-15-73" href="#__codelineno-15-73"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/Gym/gym/.tox/py3/bin:<span class="nv">$PATH</span>
</span><span id="__span-15-74"><a id="__codelineno-15-74" name="__codelineno-15-74" href="#__codelineno-15-74"></a>
</span><span id="__span-15-75"><a id="__codelineno-15-75" name="__codelineno-15-75" href="#__codelineno-15-75"></a>%runscript
</span><span id="__span-15-76"><a id="__codelineno-15-76" name="__codelineno-15-76" href="#__codelineno-15-76"></a><span class="w">        </span><span class="nb">exec</span><span class="w"> </span>/bin/sh<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</span></code></pre></div>
<p>Here is the same recipe but written for TensorFlow:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">#This is a dockerfile that sets up a full Gym install with test dependencies</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>Bootstrap:<span class="w"> </span>docker
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># Here we ll build our container upon the tensorflow container</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>From:<span class="w"> </span>tensorflow/tensorflow:latest-gpu-py3
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1"># Now we&#39;ll copy the mjkey file located in the current directory inside the container&#39;s root</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c1"># directory</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>%files
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">        </span>mjkey.txt
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c1"># Then we put everything we need to install</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>%post
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">        </span>apt<span class="w"> </span>-y<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">        </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>keyboard-configuration<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">        </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">        </span>python3-setuptools<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">        </span>python3-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">        </span>python-pyglet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">        </span>python3-opengl<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="w">        </span>libjpeg-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="w">        </span>libboost-all-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="w">        </span>libsdl2-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="w">        </span>libosmesa6-dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="w">        </span>patchelf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="w">        </span>ffmpeg<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="w">        </span>xvfb<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="w">        </span>wget<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="w">        </span>git<span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="w">        </span>unzip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="w">        </span>apt<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="w">        </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="w">        </span><span class="c1"># Download Gym and MuJoCo</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="w">        </span>mkdir<span class="w"> </span>/Gym<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/Gym
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a><span class="w">        </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/openai/gym.git<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="w">        </span>mkdir<span class="w"> </span>/Gym/.mujoco<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/Gym/.mujoco
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="w">        </span>wget<span class="w"> </span>https://www.roboti.us/download/mjpro150_linux.zip<span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="w">        </span>unzip<span class="w"> </span>mjpro150_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="w">        </span>wget<span class="w"> </span>https://www.roboti.us/download/mujoco200_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="w">        </span>unzip<span class="w"> </span>mujoco200_linux.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="w">        </span>mv<span class="w"> </span>mujoco200_linux<span class="w"> </span>mujoco200
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="w">        </span><span class="c1"># Export global environment variables</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MJKEY_PATH</span><span class="o">=</span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MUJOCO_PATH</span><span class="o">=</span>/Gym/.mujoco/mujoco150/
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mjpro150/bin
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mujoco200/bin
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/bin
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a><span class="w">        </span>cp<span class="w"> </span>/mjkey.txt<span class="w"> </span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a><span class="w">        </span><span class="c1"># Install Python dependencies</span>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a><span class="w">        </span>wget<span class="w"> </span>https://raw.githubusercontent.com/openai/mujoco-py/master/requirements.txt
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a><span class="w">        </span><span class="c1"># Install Gym and MuJoCo</span>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a><span class="w">        </span><span class="nb">cd</span><span class="w"> </span>/Gym/gym
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;.[all]&#39;</span>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a><span class="w">        </span><span class="c1"># Change permission to use mujoco_py as non sudoer user</span>
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a><span class="w">        </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">777</span><span class="w"> </span>/usr/local/lib/python3.5/dist-packages/mujoco_py/
</span><span id="__span-16-60"><a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a>
</span><span id="__span-16-61"><a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a><span class="w">        </span><span class="c1"># Then install miniworld</span>
</span><span id="__span-16-62"><a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a><span class="w">        </span><span class="nb">cd</span><span class="w"> </span>/usr/local/
</span><span id="__span-16-63"><a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a><span class="w">        </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/maximecb/gym-miniworld.git
</span><span id="__span-16-64"><a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a><span class="w">        </span><span class="nb">cd</span><span class="w"> </span>gym-miniworld
</span><span id="__span-16-65"><a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a><span class="w">        </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</span><span id="__span-16-66"><a id="__codelineno-16-66" name="__codelineno-16-66" href="#__codelineno-16-66"></a>
</span><span id="__span-16-67"><a id="__codelineno-16-67" name="__codelineno-16-67" href="#__codelineno-16-67"></a><span class="c1"># Export global environment variables</span>
</span><span id="__span-16-68"><a id="__codelineno-16-68" name="__codelineno-16-68" href="#__codelineno-16-68"></a>%environment
</span><span id="__span-16-69"><a id="__codelineno-16-69" name="__codelineno-16-69" href="#__codelineno-16-69"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span><span id="__span-16-70"><a id="__codelineno-16-70" name="__codelineno-16-70" href="#__codelineno-16-70"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MJKEY_PATH</span><span class="o">=</span>/Gym/.mujoco/mjkey.txt
</span><span id="__span-16-71"><a id="__codelineno-16-71" name="__codelineno-16-71" href="#__codelineno-16-71"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">MUJOCO_PY_MUJOCO_PATH</span><span class="o">=</span>/Gym/.mujoco/mujoco150/
</span><span id="__span-16-72"><a id="__codelineno-16-72" name="__codelineno-16-72" href="#__codelineno-16-72"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mjpro150/bin
</span><span id="__span-16-73"><a id="__codelineno-16-73" name="__codelineno-16-73" href="#__codelineno-16-73"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/Gym/.mujoco/mujoco200/bin
</span><span id="__span-16-74"><a id="__codelineno-16-74" name="__codelineno-16-74" href="#__codelineno-16-74"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/bin
</span><span id="__span-16-75"><a id="__codelineno-16-75" name="__codelineno-16-75" href="#__codelineno-16-75"></a><span class="w">        </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/Gym/gym/.tox/py3/bin:<span class="nv">$PATH</span>
</span><span id="__span-16-76"><a id="__codelineno-16-76" name="__codelineno-16-76" href="#__codelineno-16-76"></a>
</span><span id="__span-16-77"><a id="__codelineno-16-77" name="__codelineno-16-77" href="#__codelineno-16-77"></a>%runscript
</span><span id="__span-16-78"><a id="__codelineno-16-78" name="__codelineno-16-78" href="#__codelineno-16-78"></a><span class="w">        </span><span class="nb">exec</span><span class="w"> </span>/bin/bash<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</span></code></pre></div>
<p>Keep in mind that those environment variables are sourced at runtime and not at
build time. This is why, you should also define them in the <code>%post</code> section
since they are required to install MuJoCo.</p>
<h2 id="using-containers-on-clusters">Using containers on clusters<a class="headerlink" href="#using-containers-on-clusters" title="Permanent link">&para;</a></h2>
<h3 id="how-to-use-containers-on-clusters">How to use containers on clusters<a class="headerlink" href="#how-to-use-containers-on-clusters" title="Permanent link">&para;</a></h3>
<p>On every cluster with Slurm, datasets and intermediate results should go in
<code>$SLURM_TMPDIR</code> while the final experiment results should go in <code>$SCRATCH</code>.
In order to use the container you built, you need to copy it on the cluster you
want to use.</p>
<div class="admonition warning">
<p class="admonition-title">You should always store your container in $SCRATCH!</p>
<p>Then reserve a node with srun/sbatch, copy the container and your dataset on
the node given by SLURM (i.e in <code>$SLURM_TMPDIR</code>) and execute the code <code>&lt;YOUR_CODE&gt;</code> within the container <code>&lt;YOUR_CONTAINER&gt;</code> with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">  </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">  </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span>python<span class="w"> </span>&lt;YOUR_CODE&gt;
</span></code></pre></div>
</div>
<p>Remember that <code>/dataset</code>, <code>/tmp_log</code> and <code>/final_log</code> were created in the
previous section. Now each time, we'll use singularity, we are explicitly
telling it to mount <code>$SLURM_TMPDIR</code> on the cluster's node in the folder
<code>/dataset</code> inside the container with the option <code>-B</code> such that each dataset
downloaded by PyTorch in <code>/dataset</code> will be available in <code>$SLURM_TMPDIR</code>.</p>
<p>This will allow us to have code and scripts that are invariant to the cluster
environment. The option <code>-H</code> specify what will be the container's home. For
example, if you have your code in <code>$HOME/Project12345/Version35/</code> you can
specify <code>-H $HOME/Project12345/Version35:/home</code>, thus the container will only
have access to the code inside <code>Version35</code>.</p>
<p>If you want to run multiple commands inside the container you can use:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">  </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;pwd &amp;&amp; ls &amp;&amp; python &lt;YOUR_CODE&gt;&#39;</span>
</span></code></pre></div>
<h4 id="example-interactive-case-srunsalloc">Example: Interactive case (srun/salloc)<a class="headerlink" href="#example-interactive-case-srunsalloc" title="Permanent link">&para;</a></h4>
<p>Once you get an interactive session with SLURM, copy <code>&lt;YOUR_CONTAINER&gt;</code> and
<code>&lt;YOUR_DATASET&gt;</code> to <code>$SLURM_TMPDIR</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># 0. Get an interactive session</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>$<span class="w"> </span>srun<span class="w"> </span>--gres<span class="o">=</span>gpu:1
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># 1. Copy your container on the compute node</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>$<span class="w"> </span>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c1"># 2. Copy your dataset on the compute node</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>$<span class="w"> </span>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_DATASET&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span></code></pre></div>
<p>Then use <code>singularity shell</code> to get a shell inside the container</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># 3. Get a shell in your environment</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>$<span class="w"> </span>singularity<span class="w"> </span>shell<span class="w"> </span>--nv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">          </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">          </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c1"># 4. Execute your code</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>&lt;Singularity_container&gt;$<span class="w"> </span>python<span class="w"> </span>&lt;YOUR_CODE&gt;
</span></code></pre></div>
<p><strong>or</strong> use <code>singularity exec</code> to execute <code>&lt;YOUR_CODE&gt;</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># 3. Execute your code</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>$<span class="w"> </span>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">          </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">          </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">          </span>python<span class="w"> </span>&lt;YOUR_CODE&gt;
</span></code></pre></div>
<p>You can create also the following alias to make your life easier.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">alias</span><span class="w"> </span><span class="nv">my_env</span><span class="o">=</span><span class="s1">&#39;singularity exec --nv \</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="s1">          -H $HOME:/home \</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="s1">          -B $SLURM_TMPDIR:/dataset/ \</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="s1">          -B $SLURM_TMPDIR:/tmp_log/ \</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="s1">          -B $SCRATCH:/final_log/ \</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="s1">          $SLURM_TMPDIR/&lt;YOUR_CONTAINER&gt;&#39;</span>
</span></code></pre></div></p>
<p>This will allow you to run any code with:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>my_env<span class="w"> </span>python<span class="w"> </span>&lt;YOUR_CODE&gt;
</span></code></pre></div></p>
<h4 id="example-sbatch-case">Example: sbatch case<a class="headerlink" href="#example-sbatch-case" title="Permanent link">&para;</a></h4>
<p>You can also create a <code>sbatch</code> script:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c1">#SBATCH --cpus-per-task=6         # Ask for 6 CPUs</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1">#SBATCH --gres=gpu:1              # Ask for 1 GPU</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1">#SBATCH --mem=10G                 # Ask for 10 GB of RAM</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="c1">#SBATCH --time=0:10:00            # The job will run for 10 minutes</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="c1"># 1. Copy your container on the compute node</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="c1"># 2. Copy your dataset on the compute node</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_DATASET&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c1"># 3. Executing your code with singularity</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">          </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">          </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">          </span>python<span class="w"> </span><span class="s2">&quot;&lt;YOUR_CODE&gt;&quot;</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="c1"># 4. Copy whatever you want to save on $SCRATCH</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>/&lt;to_save&gt;<span class="w"> </span><span class="nv">$SCRATCH</span>
</span></code></pre></div>
<h4 id="issue-with-pybullet-and-opengl-libraries">Issue with PyBullet and OpenGL libraries<a class="headerlink" href="#issue-with-pybullet-and-opengl-libraries" title="Permanent link">&para;</a></h4>
<p>If you are running certain gym environments that require <code>pyglet</code>, you may
encounter a problem when running your singularity instance with the Nvidia
drivers using the <code>--nv</code> flag. This happens because the <code>--nv</code> flag also
provides the OpenGL libraries:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>libGL.so.1<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/.singularity.d/libs/libGL.so.1
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>libGLX.so.0<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/.singularity.d/libs/libGLX.so.0
</span></code></pre></div>
<p>If you don't experience those problems with <code>pyglet</code>, you probably don't need
to address this. Otherwise, you can resolve those problems by <code>apt-get install
-y libosmesa6-dev mesa-utils mesa-utils-extra libgl1-mesa-glx</code>, and then making
sure that your <code>LD_LIBRARY_PATH</code> points to those libraries before the ones in
<code>/.singularity.d/libs</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>%environment
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">     </span><span class="c1"># ...</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">     </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>/usr/lib/x86_64-linux-gnu/mesa:<span class="nv">$LD_LIBRARY_PATH</span>
</span></code></pre></div>
<h4 id="mila-cluster">Mila cluster<a class="headerlink" href="#mila-cluster" title="Permanent link">&para;</a></h4>
<p>On the Mila cluster <code>$SCRATCH</code> is not yet defined, you should add the
experiment results you want to keep in <code>/network/scratch/&lt;u&gt;/&lt;username&gt;/</code>. In
order to use the sbatch script above and to match other cluster environment's
names, you can define <code>$SCRATCH</code> as an alias for
<code>/network/scratch/&lt;u&gt;/&lt;username&gt;</code> with:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export SCRATCH=/network/scratch/</span><span class="si">${</span><span class="nv">USER</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">/</span><span class="nv">$USER</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</span></code></pre></div>
<p>Then, you can follow the general procedure explained above.</p>
<h4 id="digital-research-alliance-of-canada">Digital Research Alliance of Canada<a class="headerlink" href="#digital-research-alliance-of-canada" title="Permanent link">&para;</a></h4>
<p>Using singularity on Digital Research Alliance of Canada is similar except that
you need to add Yoshua's account name and load singularity. Here is an example
of a <code>sbatch</code> script using singularity on compute Canada cluster:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should use singularity/2.6 or singularity/3.4. There is a bug
in singularity/3.2 which makes gpu unusable.</p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="c1">#SBATCH --account=rpp-bengioy     # Yoshua pays for your job</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c1">#SBATCH --cpus-per-task=6         # Ask for 6 CPUs</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1">#SBATCH --gres=gpu:1              # Ask for 1 GPU</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1">#SBATCH --mem=32G                 # Ask for 32 GB of RAM</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c1">#SBATCH --time=0:10:00            # The job will run for 10 minutes</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1">#SBATCH --output=&quot;/scratch/&lt;user&gt;/slurm-%j.out&quot; # Modify the output of sbatch</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="c1"># 1. You have to load singularity</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>module<span class="w"> </span>load<span class="w"> </span>singularity
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="c1"># 2. Then you copy the container to the local disk</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="c1"># 3. Copy your dataset on the compute node</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SCRATCH</span>/&lt;YOUR_DATASET&gt;<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="c1"># 4. Executing your code with singularity</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>singularity<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--nv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="w">          </span>-H<span class="w"> </span><span class="nv">$HOME</span>:/home<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/dataset/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>:/tmp_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="w">          </span>-B<span class="w"> </span><span class="nv">$SCRATCH</span>:/final_log/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="w">          </span><span class="nv">$SLURM_TMPDIR</span>/&lt;YOUR_CONTAINER&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="w">          </span>python<span class="w"> </span><span class="s2">&quot;&lt;YOUR_CODE&gt;&quot;</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="c1"># 5. Copy whatever you want to save on $SCRATCH</span>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>rsync<span class="w"> </span>-avz<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>/&lt;to_save&gt;<span class="w"> </span><span class="nv">$SCRATCH</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["announce.dismiss", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.tracking", "navigation.sections", "navigation.path", "navigation.indexes", "search.suggest", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>